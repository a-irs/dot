#!/usr/bin/env bash

# adjust brightness with:
# - xbacklight (arch)
# - light (nixos)

set -euo pipefail

STEP=2
action=$1

b_plus() { xbacklight -time 100 -inc "$1" || light -A "$1"; }
b_minus() { xbacklight -time 100 -dec "$1" || light -U "$1"; }
b_set() { xbacklight -time 100 -set "$1" || light -S "$1"; }
b_get() { xbacklight -get | cut -d . -f 1 || light -G | cut -d . -f 1; }

if [[ "$action" == + ]]; then
    b_plus "$STEP"
elif [[ "$action" == - ]]; then
    b_minus "$STEP"
else
    b_set "$action"
fi

# limit to 1
if [[ "$(b_get)" -le 0 ]]; then
    b_set 1
fi
