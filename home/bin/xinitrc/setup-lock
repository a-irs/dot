#!/usr/bin/env bash

if [[ "$HOSTNAME" == x1 ]]; then
    # turn off display after 5m
    xset dpms 300 300 300 &

elif [[ "$HOSTNAME" == desk ]]; then
    # turn off display after 30m
    xset dpms 1800 1800 1800 &
fi

export XSECURELOCK_SHOW_HOSTNAME=0
export XSECURELOCK_SHOW_USERNAME=0
export XSECURELOCK_AUTH_BACKGROUND_COLOR=crimson
export XSECURELOCK_AUTH_TIMEOUT=300
export XSECURELOCK_BLANK_TIMEOUT=300
export XSECURELOCK_BLANK_DPMS_STATE=off

# dim after 3min, lock 15s later
xset s 180 15
export XSECURELOCK_DIM_TIME_MS=15000

xss-lock \
    -n /usr/lib/xsecurelock/dimmer \
    -l \
    -- sh -c "killall keepassxc; ssh-add -D; xsecurelock"
