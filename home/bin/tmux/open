#!/usr/bin/env bash

buffer=$(tmux show-buffer)
url=$(echo -n "$buffer" | grep -Eo "(http|https)://[^ >]+")

die() {
    tmux display-message "$1"
    exit 0
}

open() {
    if [[ "$OSTYPE" == darwin* ]]; then
        command open "$1"
    else
        xdg-open "$1"
    fi
}

if [[ -z "$url" ]]; then
    die "No URL found in: '$buffer'."
fi

tmux display-message "Opening $url ..." &
open "$url" &

exit 0
